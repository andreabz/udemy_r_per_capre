---
title: "R per capre - dal foglio di calcolo al report automatico"
subtitle: "Materiale di supporto per l'episodio 13 - riassumere i dati"
lang: it
format:
  pdf:
    documentclass: article
    papersize: a4
    margin-left: 2.5cm
    margin-right: 2.5cm
    margin-top: 3cm
    margin-bottom: 3cm
    fontsize: 11pt
    mainfont: Inter
    monofont: JetBrains Mono
    linkcolor: teal
    urlcolor: teal
    toc: false
---

::: {.small}
Repository del corso: <https://github.com/andreabz/udemy_r_per_capre>
:::

## Obiettivo dell'episodio

Imparare a **riassumere i dati** usando `data.table`.

Finora abbiamo lavorato su:

- singole righe
- singoli campioni
- singole misure

In un report, però, non riportiamo tutti i dati: servono **riassunti utili** per capire il dataset.


## Perché riassumere i dati

Un dataset grezzo serve a:

- lavorare
- controllare
- correggere

Un report serve a:

- capire
- confrontare
- decidere

Ridurre i dati in modo **controllato e intenzionale** è fondamentale.

## Gruppi e sintesi: l'idea chiave

Ogni riassunto combina:

1. **criterio di raggruppamento** (`by`)
2. **statistiche di sintesi** (`j`)

Sintassi `data.table`: `DT[i, j, by]`

Esempio:

```{r}
#| eval: false

misure[, .(
  campioni = uniqueN(id_campione),
  tempo_mediano = median(tempo_analisi)
), by = .(mese_inizio_analisi)]
```

- `by` definisce il gruppo
- `.()` in `j` calcola le sintesi
- il risultato non è salvato finché non lo assegni a una variabile, ad esempio:


```{r}
#| eval: false

riassunto <- misure[,
              .(
                campioni = uniqueN(id_campione),
                analisi_mediana = median(tempo_analisi |> as.numeric()),
                analisi_veloce = quantile(tempo_analisi, 0.10),
                analisi_lenta = quantile(tempo_analisi, 0.90)
                ),
              by = .(mese_inizio_analisi, id_metodo)]
```

## Riassunti e leggibilità

Un buon riassunto:

- poche colonne
- nomi chiari
- leggibile anche senza contesto

Se serve spiegare riga per riga, probabilmente la tabella è troppo complessa.

## Dal riassunto al grafico

Questo tipo di output serve per:

- grafici
- tabelle finali
- confronti temporali

Nei prossimi episodi useremo **i riassunti**, non i dati grezzi.

## Punto chiave dell'episodio

`by` permette di definire gruppi di dati su cui fare i calcoli con `j`.
I dati riassunti sono salvati in una variabile per poter essere utilizzati.


## In sintesi

- i report nascono dai riassunti, non dai dati grezzi
- `by =` definisce i gruppi
- `.()` in `j` specifica come sintetizzare i dati
- poche informazioni chiare valgono più di molte confuse

Con questo episodio abbiamo quasi tutti gli ingredienti per costruire un report completo.
