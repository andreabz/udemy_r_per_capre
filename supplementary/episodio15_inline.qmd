---
title: "R per capre - dal foglio di calcolo al report automatico"
subtitle: "Materiale di supporto per l'episodio 15 - calcoli in linea"
lang: it
format:
  pdf:
    documentclass: article
    papersize: a4
    margin-left: 2.5cm
    margin-right: 2.5cm
    margin-top: 3cm
    margin-bottom: 3cm
    fontsize: 11pt
    mainfont: Inter
    monofont: JetBrains Mono
    linkcolor: teal
    urlcolor: teal
    toc: false
---

::: {.small}
Repository del corso: <https://github.com/andreabz/udemy_r_per_capre>
:::

## Obiettivo dell'episodio

Inserire **risultati di calcoli direttamente nel testo del report** così da non aggiornare più il testo a mano quando cambiano i dati.


## Il problema del testo scritto a mano

Un report manuale contiene frasi tipo:

> Nel 2024 sono stati analizzati 123 campioni.

Se cambiano i dati, l’anno o il metodo, la frase diventa sbagliata e richiede intervento manuale.


## La soluzione: calcoli inline

Quarto permette di inserire **codice R direttamente nel testo** con la sintassi ``` `r codice_R` ```.

- Il codice viene eseguito
- Il risultato sostituisce il codice nel report finale
- Il codice non compare nel PDF o HTML finale

## Esempio base

```
Nel `r params$year` sono stati analizzati 
`r misure[id_metodo == params$method & 
tempo_analisi > params$target, uniqueN(id_campione)]` 
campioni con tempi di analisi superiori all'obiettivo 
di `r params$target` giorni. 
```

Nel report finale comparirà qualcosa come:

> Nel 2024 sono stati analizzati 65 campioni con tempi di analisi superiori all'obiettivo di 15 giorni.

Senza scrivere nulla a mano.

## Quando usare i calcoli inline

**Ideale per**:

- numeri singoli
- conteggi
- valori che entrano in una frase

**Da evitare**:

- codice lungo
- trasformazioni complesse
- calcoli difficili da leggere

**Regola pratica**: se il risultato non può essere letto come parte di una frase, non metterlo inline.

## Perché è importante 

I calcoli inline permettono di:

- mantenere coerenti testo, grafici e tabelle
- evitare errori silenziosi
- aggiornare il report solo cambiando dati o parametri

## Punto chiave

Possiamo integrare il risultato di calcolo nel testo con la sintassi ``` `r espressione` ```.
Il risultato si sarà ricalcolato a ogni aggiornamento del report.


## In sintesi

- i calcoli inline inseriscono risultati direttamente nel testo
- il codice non appare nel report finale
- servono per evitare copia-incolla e errori
- devono essere semplici e leggibili
- si scrivono come ``` `r espressione` ```

Con questo episodio otteniamo:

- report automatico con valori aggiornati nel testo
- numero di campioni con tempi superiori al target
